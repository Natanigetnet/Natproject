<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Spotify Lite - Simplified</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      .page-section { display: none; }
      .active-section { display: block; }
    </style>
  </head>
<body class="p-4" style="background: url('https://th.bing.com/th/id/OIF.KMHm2k6scEsRhNJYdg7dkQ?w=310&h=174&c=7&r=0&o=7&dpr=1.3&pid=1.7&rm=3') no-repeat center center fixed; background-size: cover; color: white;">
    <nav class="navbar navbar-expand-lg navbar-dark bg-grey mb-4">
      <div class="container-fluid">
        <a class="navbar-brand" href="#" style="font-size: 2.6rem; color: rgb(10, 146, 10);"><strong>Spotify Lite</strong></a>
        <div>
          <ul class="navbar-nav me-auto mb-2 mb-lg-0 d-flex flex-row gap-3">
            <li class="nav-item"><a class="nav-link" style="font-size: 1.5rem; color: rgb(74, 213, 20);" href="#" onclick="showSection('search')"><strong>Search</strong></a></li>
            <li class="nav-item"><a class="nav-link" style="font-size: 1.5rem; color: rgb(75, 212, 11);" href="#" onclick="showSection('playlist')"><strong>Playlist</strong></a></li>
            <li class="nav-item"><a class="nav-link" style="font-size: 1.5rem; color: rgb(89, 245, 11);" href="#" onclick="showSection('analytics')"><strong>Analytics</strong></a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
      <div id="search" class="page-section active-section">
        <div class="mb-4">
          <div class="input-group input-group-sm justify-content-end">
            <strong><input type="text" id="searchInput" style="background-color:rgb(133, 154, 142)" class="form-control form-control-sm w-10" placeholder="Search for song "></strong>
            <button class="btn btn-primary " style="background-color: green;" onclick="searchSongs()"><strong>Search</strong></button>
          </div>
        </div>
        <div id="songsContainer" class="row mb-5"></div>
      </div>

      <div id="playlist" class="page-section">
        <h5>Playlist</h5>
        <div class="table-responsive">
          <input class=" mb-2" id="searchPlaylistInput" placeholder="Search songs in playlist" style="background-color: gray;">
          <table class="table table-striped table-dark table-hover" style="background-color: rgba(40, 40, 40, 0.6);">
            <thead>
              <tr>
                <th>#</th>
                <th>Title</th>
                <th>Artist</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="playlistTable"></tbody>
          </table>
        </div>
      </div>

      <div id="analytics" class="page-section">
        <h5>Songs Per Artist Chart</h5>
        <div class="d-flex justify-content-center">
         <canvas id="songChart" style="width: 600px;height: 800px;"></canvas>

        </div>
        <button class="btn btn-secondary mt-2" onclick="toggleChartType()">Toggle Chart</button>
      </div>
    </div>

    <script>
      let playlist = [];
      let chart;
      let chartType = 'bar';

      function showSection(id) {
        document.querySelectorAll('.page-section').forEach(section => {
          section.classList.remove('active-section');
        });
        document.getElementById(id).classList.add('active-section');
      }

      function searchSongs() {
        const query = document.getElementById('searchInput').value;
        if (!query) return;

        fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(query)}&limit=12&entity=song`)
          .then(response => response.json())
          .then(data => {
            const container = document.getElementById('songsContainer');
            container.innerHTML = '';

            data.results.forEach(song => {
              const col = document.createElement('div');
              col.className = 'col-md-4';
              col.innerHTML = `
                <div class="card text-white mb-3" style="background-color: rgba(40, 40, 40, 0.7);"> 
                  <div class="card-body">
                    <div class="d-flex align-items-center">
                      <img src="${song.artworkUrl100}" class="rounded me-3" style="width: 64px; height: 64px; object-fit: cover;" alt="cover">
                      <div>
                        <h6 class="card-title mb-1">${song.trackName}</h6>
                        <p class="card-text small mb-1">${song.artistName}</p>
                        <button class="btn btn-sm btn-outline-light" onclick='addToPlaylist(${JSON.stringify(song)})'>Add to Playlist</button>
                      </div>
                    </div>
                  </div>
                </div>`;
              container.appendChild(col);
            });
          });
      }

      function addToPlaylist(song) {
        playlist.push({ title: song.trackName, artist: song.artistName });
        updatePlaylistTable();
        updateArtistChart();
      }

      function updatePlaylistTable() {
        const tbody = document.getElementById('playlistTable');
        tbody.innerHTML = '';
        const searchValue = document.getElementById('searchPlaylistInput').value.toLowerCase();

        playlist.forEach((track, i) => {
          if (
            track.title.toLowerCase().includes(searchValue) ||
            track.artist.toLowerCase().includes(searchValue)
          ) {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${i + 1}</td>
              <td>${track.title}</td>
              <td>${track.artist}</td>
              <td><button class="btn btn-sm btn-danger" onclick="removeFromPlaylist(${i})">Delete</button></td>
            `;
            tbody.appendChild(row);
          }
        });
      }

      function removeFromPlaylist(index) {
        playlist.splice(index, 1);
        updatePlaylistTable();
        updateArtistChart();
      }

      document.getElementById('searchPlaylistInput').addEventListener('input', updatePlaylistTable);

      function updateArtistChart() {
        const artistCounts = {};
        playlist.forEach(track => {
          artistCounts[track.artist] = (artistCounts[track.artist] || 0) + 1;
        });

        const labels = Object.keys(artistCounts);
        const data = Object.values(artistCounts);

        // Generate unique HSL colors for each artist
        const backgroundColors = [];
    const borderColors = [];
      for (let i = 0; i < labels.length; i++) {
          const hue = (i * 360) / labels.length;
          backgroundColors.push(`hsl(${hue}, 70%, 50%)`);
          borderColors.push(`hsl(${hue}, 70%, 40%)`);
          }

        const ctx = document.getElementById('songChart');
        if (chart) chart.destroy();
        chart = new Chart(ctx, {
          type: chartType,
          data: {
            labels: labels,
            datasets: [{
              label: 'Songs per Artist',
              data: data,
              backgroundColor: backgroundColors,
              borderColor: borderColors,
              borderWidth: 2
            }]
          },
          options: {
            responsive: false,
            plugins: { legend: { display: chartType === 'pie' } },
            scales: chartType === 'bar' ? {
              y: {
                beginAtZero: true,
                ticks: { color: '#fff' },
                title: { display: true, text: 'Number of Songs', color: '#fff' }
              },
              x: {
                ticks: { color: '#fff' },
                title: { display: true, text: 'Artists', color: '#fff' }
              }
            } : {}
          }
        });
      }

      function toggleChartType() {
        chartType = chartType === 'bar' ? 'pie' : 'bar';
        updateArtistChart();
      }
    </script>
  </body>
</html>
